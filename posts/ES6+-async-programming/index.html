<!DOCTYPE html><html lang="ko-KR" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-proxy-endpoint" content=""><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="ES6+ 비동기 프로그래밍" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="개요" /><meta property="og:description" content="개요" /><link rel="canonical" href="https://soonj817.github.io/posts/ES6+-async-programming/" /><meta property="og:url" content="https://soonj817.github.io/posts/ES6+-async-programming/" /><meta property="og:site_name" content="SoonJ" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-12T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="ES6+ 비동기 프로그래밍" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"개요","headline":"ES6+ 비동기 프로그래밍","dateModified":"2021-04-12T00:00:00+09:00","url":"https://soonj817.github.io/posts/ES6+-async-programming/","datePublished":"2021-04-12T00:00:00+09:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://soonj817.github.io/posts/ES6+-async-programming/"},"@context":"https://schema.org"}</script><title>ES6+ 비동기 프로그래밍 | SoonJ</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script async src="/assets/js/dist/pvreport.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-WWFW42XEDP"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-WWFW42XEDP'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/commons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">SoonJ</a></div><div class="site-subtitle font-italic">[INTP]: A logical thinker</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/soonJ817" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['soonj0817','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>ES6+ 비동기 프로그래밍</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>ES6+ 비동기 프로그래밍</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Soon Jae Jung </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Apr 12, 2021, 12:00 AM +0900" prep="on" > Apr 12 <i class="unloaded">2021-04-12T00:00:00+09:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2771 words">15 min</span> <span id="pv" class="pageviews"><i class="fas fa-spinner fa-spin fa-fw"></i></span></div></div><div class="post-content"><h1 id="개요">개요</h1><p>자바스크립트의 버전 ES6 이상에서의 비동기 처리와 에러 핸들링에 대해 코드를 예시로 가이드를 제공한다.</p><ul><li>자바스크립트에 대한 기본적인 지식 필요<li>제너레이터, 이터레이터, 이터러블, 함수형 프로그래밍, 특히 순수함수에 대해 선행학습을 권장한다.<li>순수 함수 등의 함수형 프로그래밍 지식에 대해 서술하는 것은 주제를 벗어나므로 해당 일감에선 배제한다.</ul><h1 id="가이드">가이드</h1><h2 id="문제">문제</h2><p>만약 외부 이미지의 높이를 합산해야되는 업무가 있다고 가정하자. 자바스크립트로 작성하게 될 경우, 아래와 같은 코드가 기본적으로 연상될 것이다.</p><p>[코드 1]</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="p">{</span><span class="nx">log</span><span class="p">,</span> <span class="nx">clear</span><span class="p">}</span> <span class="o">=</span> <span class="nx">console</span><span class="p">;</span>

<span class="c1">// 올바른 객체</span>
<span class="kd">const</span> <span class="nx">imgObjs</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">HEART</span><span class="dl">"</span><span class="p">,</span> <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://s3.marpple.co/files/m2/t3/colored_images/45_1115570_1162087_150x0.png</span><span class="dl">"</span> <span class="p">},</span>
  <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6</span><span class="dl">"</span><span class="p">,</span> <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://s3.marpple.co/f1/2018/1/1054966_1516076919028_64501_150x0.png</span><span class="dl">"</span><span class="p">},</span>
  <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">하트</span><span class="dl">"</span><span class="p">,</span> <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://s3.marpple.co/f1/2019/1/1235206_1548918825999_78819_150x0.png</span><span class="dl">"</span> <span class="p">},</span>
  <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">도넛</span><span class="dl">"</span><span class="p">,</span> <span class="na">url</span><span class="p">:</span><span class="dl">"</span><span class="s2">https://s3.marpple.co/f1/2019/1/1235206_1548918758054_55883_150x0.png</span><span class="dl">"</span><span class="p">},</span>
<span class="p">];</span>

<span class="c1">// 잘못된 요소가 포함된 객체</span>
<span class="kd">const</span> <span class="nx">imgObjs2</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">HEART</span><span class="dl">"</span><span class="p">,</span> <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://s3.marpple.co/files/m2/t3/colored_images/45_1115570_1162087_150x0.png</span><span class="dl">"</span> <span class="p">},</span>
  <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6</span><span class="dl">"</span><span class="p">,</span> <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://s3.marpple.co/f1/2018/1/1054966_1516076919028_64501_150x0.jpg</span><span class="dl">"</span><span class="p">},</span>  <span class="c1">// &lt;-- png를 jpg로 수정</span>
  <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">하트</span><span class="dl">"</span><span class="p">,</span> <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://s3.marpple.co/f1/2019/1/1235206_1548918825999_78819_150x0.png</span><span class="dl">"</span> <span class="p">},</span>
  <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">도넛</span><span class="dl">"</span><span class="p">,</span> <span class="na">url</span><span class="p">:</span><span class="dl">"</span><span class="s2">https://s3.marpple.co/f1/2019/1/1235206_1548918758054_55883_150x0.png</span><span class="dl">"</span><span class="p">},</span>
<span class="p">];</span>

<span class="c1">// 모든 이미지의 높이를 더하는 함수</span>
<span class="kd">const</span> <span class="nx">getImageHeight</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">imgObjs</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">obj</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="kd">let</span> <span class="nx">img</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Image</span><span class="p">();</span>
  	<span class="nx">img</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">url</span><span class="p">;</span>
  	<span class="k">return</span> <span class="nx">img</span><span class="p">;</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">img</span> <span class="o">=&gt;</span> <span class="nx">img</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">cur</span><span class="p">,</span><span class="nx">acc</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">cur</span><span class="o">+</span><span class="nx">acc</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">};</span>

<span class="nx">log</span><span class="p">(</span><span class="nx">getImageHeight</span><span class="p">());</span>
</pre></table></code></div></div><p>하지만 위 코드를 실행하면 결과값은 0이 나온다. 왜일까? new Image()를 할당한 객체는 페이지 로드 이후에 image를 불러오게 된다. 이 과정에서 io 이벤트가 발생하여 비동기로 동작하게 된다. 아래 코드를 추가하면 onload 이후에 img에서 height이 정상 출력됨을 확인할 수 있다.</p><p>[코드 2]</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nx">img</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  	<span class="nx">log</span><span class="p">(</span><span class="nx">img</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>그렇다면 이 비동기 동작을 어떻게 동기적으로 처리해야 할까?</p><h2 id="나쁜-코드-예시">나쁜 코드 예시</h2><p>Promise 객체를 리턴해주면 resolve 트리거가 올때까지 wait 상태가 된다. 이를 이용해 비동기 처리를 할 수 있다.</p><p>[코드 3]</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>    <span class="c1">// 이미지 로드 함수</span>
    <span class="kd">const</span> <span class="nx">loadImage</span> <span class="o">=</span> <span class="nx">url</span> <span class="o">=&gt;</span>
      <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">img</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Image</span><span class="p">();</span>
        <span class="nx">img</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">url</span><span class="p">;</span>
        <span class="nx">img</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="nx">resolve</span><span class="p">(</span><span class="nx">img</span><span class="p">);</span>
        <span class="p">};</span>
        <span class="nx">img</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">reject</span><span class="p">(</span><span class="dl">'</span><span class="s1">error!!!</span><span class="dl">'</span><span class="p">);</span>
        <span class="p">};</span>
      <span class="p">});</span>

    <span class="c1">// 이미지 높이 더하는 함수</span>
    <span class="kd">const</span> <span class="nx">getImageHeight</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">imgObjs</span>
        <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">async</span> <span class="nx">obj</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="k">await</span> <span class="nx">loadImage</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">url</span><span class="p">)).</span><span class="nx">height</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="k">async</span> <span class="p">(</span><span class="nx">cur</span><span class="p">,</span> <span class="nx">acc</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="k">await</span> <span class="nx">cur</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="k">await</span> <span class="nx">acc</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="nx">getImageHeight</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="nx">log</span><span class="p">);</span>
</pre></table></code></div></div><p>먼저 load 동작을 함수로 선언한 다음 promise type으로 래핑했다. 그 후, 함수 호출부는 async/await으로 처리하였다. 585가 출력되었다면 정상적으로 출력된 것이다.</p><p>하지만 이는 그리 좋은 코드가 아니다. 예시로 작성해놓은 imgObjs2를 보면, 파일 하나가 jpg로 되어 있는데 이는 원래 png 파일을 오동작하도록 임의로 변경한 것이다. imgObjs2를 getImageHeight의 리턴 객체에 넣어보면 에러가 발생한다.</p><p>잘못된 이미지 파일을 걸러내기 위해 try / catch 로 처리해보자</p><p>[코드 4]</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">getImageHeight</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">imgObjs2</span>  <span class="c1">// &lt;-- 잘못된 객체로 변경</span>
          <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">async</span> <span class="nx">obj</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
              <span class="k">return</span> <span class="p">(</span><span class="k">await</span> <span class="nx">loadImage</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">url</span><span class="p">)).</span><span class="nx">height</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
              <span class="k">throw</span> <span class="nx">e</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="p">})</span>
          <span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="k">async</span> <span class="p">(</span><span class="nx">cur</span><span class="p">,</span> <span class="nx">acc</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="k">await</span>  <span class="nx">cur</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="k">await</span> <span class="nx">acc</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">e</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">error!!!</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">log</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">};</span>
</pre></table></code></div></div><p>try / catch 로 문제가 발생하는 부분을 묶어 throw로 던져주고, 바깥에서 이를 처리하였다. 모양새가 별로지만 그럭저럭 에러 핸들링이 된 느낌이다. 하지만 이 코드에는 에러 핸들링 이전보다 더욱 치명적인 결함이 있다. img.onload 함수 위에 로그를 찍어보자.</p><p>[코드 5]</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>        <span class="p">...</span>
        <span class="nx">img</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">url</span><span class="p">;</span>
        <span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">함수 호출!!!</span><span class="dl">'</span><span class="p">,</span> <span class="nx">url</span><span class="p">)</span>
        <span class="nx">img</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="nx">resolve</span><span class="p">(</span><span class="nx">img</span><span class="p">);</span>
        <span class="p">};</span>
        <span class="p">...</span>
</pre></table></code></div></div><p>출력되는 로그를 살펴보면 에러가 발생함에도 이후 반복문이 계속 동작함을 알 수 있다. 에러 핸들링으로 에러를 처리했기 때문에 우리는 예외 처리가 완료되었다고 생각하지만, 이는 더 큰 결함을 발생시킬 수 있는 가능성을 내제하고 있다. 생각보다 이런 경우는 우리가 개발할 때 흔히 발생할 수 있는 케이스이며, 대부분의 자바스크립트 개발자는 한번쯤 이렇게 코드를 생산해본 경험이 있을 것이다. 그렇다면 과연 이 비동기 동작과 에러를 어떻게 처리하는게 깔끔한 방법일까?</p><h2 id="좋은-코드-예시">좋은 코드 예시</h2><p>먼저 방금 전의 코드를 살펴보자.</p><p>[코드 6]</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>    <span class="kd">const</span> <span class="nx">getImageHeight</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">imgObjs</span>
        <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">async</span> <span class="nx">obj</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="k">await</span> <span class="nx">loadImage</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">url</span><span class="p">)).</span><span class="nx">height</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="k">async</span> <span class="p">(</span><span class="nx">cur</span><span class="p">,</span> <span class="nx">acc</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="k">await</span> <span class="nx">cur</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="k">await</span> <span class="nx">acc</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="nx">getImageHeight2</span><span class="p">();</span>
</pre></table></code></div></div><p>이곳에서 map 함수를 직접 구현해볼 것이다. map 함수는 제너레이터를 이용해서 구현해보았으며, reduce 함수는 잠시 변수 형태로 풀어서 작성하였다. 내부 map(오른쪽)은 imgObjs 배열을 받아서 img 객체를 로드하여 배열 형태로 반환한다. 외부 map(왼쪽)은 받아온 img 객체에서 height를 뽑아내어 배열 형태로 반환한다.</p><p>여기서 중요한 것은 map 함수인데</p><ul><li>이터레이터를 추상화하고,<li>바깥에서 일으키고자 하는 부수효과를 내부에서 발생시키고,<li>어떤 값을 꺼내갈 것이냐를 직접 기입하는 것이 아니라 함수에게 완전히 위임한다. 이것이 오늘의 핵심이다.</ul><p>[코드 7]</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>
<span class="c1">// 제너레이터를 이용한 map 함수 구현</span>
<span class="kd">function</span><span class="o">*</span> <span class="nx">map</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">iter</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">val</span> <span class="k">of</span> <span class="nx">iter</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">yield</span> <span class="nx">f</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// reduce를 풀어서 작성하고 try/catch 추가</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">getImageHeight2</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">try</span><span class="p">{</span>
    <span class="kd">let</span> <span class="nx">acc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="k">await</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">val</span> <span class="k">of</span> <span class="nx">map</span><span class="p">(</span><span class="nx">img</span> <span class="o">=&gt;</span> <span class="nx">img</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span> <span class="nx">map</span><span class="p">(({</span><span class="nx">url</span><span class="p">})</span><span class="o">=&gt;</span> <span class="nx">loadImage</span><span class="p">(</span><span class="nx">url</span><span class="p">),</span> <span class="nx">imgObjs</span><span class="p">)))</span> <span class="p">{</span>
      <span class="nx">acc</span> <span class="o">=</span> <span class="nx">acc</span> <span class="o">+</span> <span class="nx">val</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">log</span><span class="p">(</span><span class="nx">acc</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">log</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
  
<span class="p">}</span>
<span class="nx">getImageHeight2</span><span class="p">();</span>
</pre></table></code></div></div><p>위 코드를 실행하면 결과가 NaN으로 출력될 것이다. 왜일까? 구현한 map 함수 반복문 내부에서 로그를 찍어보면 다음과 같이 출력되는 것을 확인할 수 있다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/images/picture232-1.png" alt="로그 출력 결과" /></p><p>JSON 객체 타입으로 출력된 것은 내부 map(오른쪽)이 실행됨에 따라 그 이터레이터의 value 값이 출력된 것이고, Promise 타입으로 출력된 것은 외부 map(왼쪽)이 실행되면서 내부 map에서 리턴된 타입이 Promise 타입이기에 저런 결과가 나온 것이다. 이것은 구현한 map에서 이터레이터 값의 타입에 따라 그에 맞는 동작을 수행하도록 처리하여 해결한다.</p><p>[코드 8]</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c1">// 인스턴스 타입에 따라 분기 처리</span>
<span class="kd">function</span><span class="o">*</span> <span class="nx">_map</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">iter</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">val</span> <span class="k">of</span> <span class="nx">iter</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">yield</span> <span class="nx">val</span> <span class="k">instanceof</span> <span class="nb">Promise</span> <span class="p">?</span> <span class="nx">val</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">f</span><span class="p">):</span> <span class="nx">f</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>실행해보면 정상 출력됨을 확인할 수 있다.</p><p>이제 reduce도 직접 정의해보자 비동기를 다룰 수 있는 reduce를 제작하기 위해 reduceAsync 함수를 정의한다.</p><p>map과 마찬가지로</p><ul><li>이터레이터를 추상화하고,<li>바깥에서 일으키고자 하는 부수효과를 내부에서 발생시키고,<li>어떤 값을 꺼내갈 것이냐를 직접 기입하는 것이 아니라 함수에게 완전히 위임한다.</ul><p>[코드 9]</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">async</span> <span class="kd">function</span> <span class="nx">reduceAsync</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">acc</span><span class="p">,</span> <span class="nx">iter</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">for</span> <span class="k">await</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">val</span> <span class="k">of</span> <span class="nx">iter</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">acc</span> <span class="o">=</span> <span class="nx">f</span><span class="p">(</span><span class="nx">acc</span><span class="p">,</span><span class="nx">val</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="nx">acc</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>이렇게 map과 reduce를 구현하면 getImageHeight함수를 깔끔하게 정리할 수 있다. <code class="language-plaintext highlighter-rouge">내부에서의 try / catch문을 제거하고 함수 호출부문에서 예외처리를 하도록 유도한다.</code></p><p>[코드 10]</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">getImageHeight2</span> <span class="o">=</span> <span class="nx">imgs</span> <span class="o">=&gt;</span> 
    <span class="nx">reduceAsync</span><span class="p">((</span><span class="nx">cur</span><span class="p">,</span><span class="nx">acc</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">cur</span> <span class="o">+</span> <span class="nx">acc</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
  	      <span class="nx">map</span><span class="p">(</span><span class="nx">img</span> <span class="o">=&gt;</span> <span class="nx">img</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span>
  	        <span class="nx">map</span><span class="p">(({</span><span class="nx">url</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="nx">loadImage</span><span class="p">(</span><span class="nx">url</span><span class="p">),</span> <span class="nx">imgs</span><span class="p">))</span>
  	<span class="p">)</span>

<span class="nx">getImageHeight2</span><span class="p">(</span><span class="nx">imgObjs</span><span class="p">).</span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">err</span><span class="dl">'</span><span class="p">)).</span><span class="nx">then</span><span class="p">(</span><span class="nx">log</span><span class="p">);</span>
<span class="nx">getImageHeight2</span><span class="p">(</span><span class="nx">imgObjs2</span><span class="p">).</span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">err</span><span class="dl">'</span><span class="p">)).</span><span class="nx">then</span><span class="p">(</span><span class="nx">log</span><span class="p">);</span>
</pre></table></code></div></div><p>왜 이렇게 기본 메소드를 힘들게 구현했을까? 이전 img.onload 이전 찍었던 로그가 남아있다면 이유를 알 수 있다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/images/picture232-2.png" alt="로그 출력 결과" /></p><p>함수 호출이 진행되다가 에러를 만나자 에러를 발산하고 반복이 중단된다.</p><h1 id="정리">정리</h1><p>지금까지 비동기 처리와 에러 핸들링에 대해 다루어보았다. 이 예시의 핵심은 <code class="language-plaintext highlighter-rouge">에러를 분출시킨다</code> 는 것이다. 함수 내부에서 try / catch나 if 문으로 에러 핸들링을 하는 것은 함수의 용도를 제약시키고 코드를 사용하는 유저에게 확장성 있는 기능을 제공하기 어렵다.</p><ul><li>어떤 유저는 글로벌 필터에서 에러 핸들링을 하길 원할 수 있다.<li>어떤 유저는 함수 호출부에서 에러 핸들링을 하길 원할 수 있다. 만약 함수 내부에서 나쁜 예시와 같은 부수효과를 작성하게 될 경우 위 케이스들과 같은 유저들은 절대 원하는 값을 얻을 수 없다. 심지어 내부의 try/catch에서 throw가 실수로 빠지는 등 어설프게 작성되었다면 치명적인 결과를 초래할 수 있다. <code class="language-plaintext highlighter-rouge">순수함수</code> 로 작성했다면 그 함수는 올바른 input이 들어왔다면 반드시 보장된 output이 존재하기 때문에 예외처리는 불필요하며 위와 같은 이유로 해서도 안된다.</ul><p>지금까지의 내용을 정리해보면 다음과 같다.</p><ol><li>Promise, async/await, try/catch를 정확히 다루는 것이 중요하다.<li>제너레이터/이터레이터/이터러블을 잘 응용하면 코드의 표현력을 더할 뿐 아니라 에러 핸들링도 더 잘할 수 있다.<li>순수 함수에서는 에러가 발생되도록 그냥 두는 것이 더 좋다.<li>에러 핸들링 코드는 부수효과를 일으킬 코드 주변에 작성하는 것이 좋다.<li>불필요하게 에러 핸들링을 미리 해두는 것은 에러를 숨길 뿐이다.<li>발생되는 모든 에러를 확인하는 것이 고객 입장에선 좋을 수 있다.(sentry.io)</ol><h1 id="-참고문서">○ 참고문서</h1><ul><li><div class="table-wrapper"><table><tbody><tr><td>함수형 자바스크립트 프로그래밍. 유인동 저<td>인사이트(insight)</table></div><li><a href="https://www.youtube.com/watch?v=4sO0aWTd3yc&amp;ab_channel=naverd2&amp;fbclid=IwAR0b7hHb8AwexfL1PUKs2r6wKAg6gI1il5HI5oJ5HA81hdEoFeovQ3Q7jN4">함수형 프로그래밍과 ES6+</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/languages/'>languages</a>, <a href='/categories/javascript/'>javascript</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/javascript/" class="post-tag no-text-decoration" >javascript</a> <a href="/tags/es6/" class="post-tag no-text-decoration" >es6</a> <a href="/tags/programming/" class="post-tag no-text-decoration" >programming</a> <a href="/tags/exception/" class="post-tag no-text-decoration" >exception</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=ES6+ 비동기 프로그래밍 - SoonJ&url=https://soonj817.github.io/posts/ES6+-async-programming/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=ES6+ 비동기 프로그래밍 - SoonJ&u=https://soonj817.github.io/posts/ES6+-async-programming/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=ES6+ 비동기 프로그래밍 - SoonJ&url=https://soonj817.github.io/posts/ES6+-async-programming/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/wedding-review/">결혼 후기</a><li><a href="/posts/the-best-way-to-unsubscribe-in-angular/">Angular에서 unsubscribe를 사용하는 방법</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/diary/">diary</a> <a class="post-tag" href="/tags/angular/">angular</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/markdown/">markdown</a> <a class="post-tag" href="/tags/md/">md</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/design-pattern/">design-pattern</a> <a class="post-tag" href="/tags/es6/">es6</a> <a class="post-tag" href="/tags/eventemitter/">eventemitter</a> <a class="post-tag" href="/tags/exception/">exception</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/javascript-scope/"><div class="card-body"> <span class="timeago small" > Apr 13 <i class="unloaded">2021-04-13T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>스코프, 블럭 레벨/함수 레벨 스코프, lexical/동적 스코프, 스코프체인, 클로저</h3><div class="text-muted small"><p> 스코프 식별자(변수)의 유효범위 자바스크립트 변수에 대한 접근 권한을 정의하는 것이다. global 영역과 local 영역으로 나뉜다. global: 코드 어디에서든지 참조 가능 local: 함수 코드 블록이 만든 스코프, 함수 자신과 하위 함수에서만 참조 가능 var로 변수를 선언할 경우,...</p></div></div></a></div><div class="card"> <a href="/posts/must-know-to-make-application/"><div class="card-body"> <span class="timeago small" > Apr 26 <i class="unloaded">2021-04-26T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>함수형 프로그래밍 no.01</h3><div class="text-muted small"><p> 어플리케이션의 설계 요소 확장성: 추가 기능을 지원하기 위해 계속 코드를 리팩토링해야 하는가? 모듈화 용이성: 파일 하나를 고치면 다른 파일도 영향을 받는가? 재사용성: 중복이 많은가? 테스트성: 함수를 단위 테스트하기 어려운가? 헤아리기 쉬움: 체계도 없고 따라가기 어려운 코드인가? 위 목록 중 한가지라도 ‘예’ 또는 ‘잘 ...</p></div></div></a></div><div class="card"> <a href="/posts/markdown-guide/"><div class="card-body"> <span class="timeago small" > Apr 1 <i class="unloaded">2021-04-01T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>마크다운 markdown 작성법</h3><div class="text-muted small"><p> 이 문서는 링크를 복사해 가져온 포스트입니다. [공통] 마크다운 markdown 작성법 1. 마크다운에 관하여 1.1. 마크다운이란? Markdown은 텍스트 기반의 마크업언어로 2004년 존그루버에 의해 만들어졌으며 쉽게 쓰고 읽을 수 있으며 HTML로 변환이 가능하다. 특수기호와 문자를 이용한 매우 간단한 구조의 문법을 사용하여 웹에서도 보다 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/tee-usage/" class="btn btn-outline-primary" prompt="Older"><p>tee를 이용해 화면 출력과 파일을 동시에 생성해보자!</p></a> <a href="/posts/this-year's-goal/" class="btn btn-outline-primary" prompt="Newer"><p>올해 목표</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#main > div.row:first-child > div:first-child img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/soonJ817">Soon Jae Jung</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/diary/">diary</a> <a class="post-tag" href="/tags/angular/">angular</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/markdown/">markdown</a> <a class="post-tag" href="/tags/md/">md</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/design-pattern/">design pattern</a> <a class="post-tag" href="/tags/es6/">es6</a> <a class="post-tag" href="/tags/eventemitter/">eventemitter</a> <a class="post-tag" href="/tags/exception/">exception</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://soonj817.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
